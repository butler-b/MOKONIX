ASK [Run Docker Compose to start the web server] ******************************
fatal: [Docker-WEB-WAS-DB-ExMid-1]: FAILED! => {"changed": true, "cmd": "docker-compose -f /opt/MOKONIX/ansible_project/docker-compose.yml up -d --build", "delta": "0:00:06.763141", "end": "2024-08-29 10:26:18.268090", "msg": "non-zero return code", "rc": 1, "start": "2024-08-29 10:26:11.504949", "stderr": "Some networks were defined but are not used by any service: elk-network\nCreating network \"ansible_project_app-network\" with driver \"bridge\"\nBuilding app\n#0 building with \"default\" instance using docker driver\n\n#1 [internal] load build definition from Dockerfile\n#1 transferring dockerfile: 633B done\n#1 DONE 0.0s\n\n#2 [internal] load metadata for docker.io/library/python:3.9-slim\n#2 DONE 1.9s\n\n#3 [internal] load .dockerignore\n#3 transferring context: 2B done\n#3 DONE 0.0s\n\n#4 [1/7] FROM docker.io/library/python:3.9-slim@sha256:1e3437daae1d9cebce372794eacfac254dd108200e47c8b7f56a633ebd3e2a0a\n#4 DONE 0.0s\n\n#5 [internal] load build context\n#5 transferring context: 654B done\n#5 DONE 0.0s\n\n#6 [4/7] COPY requirements.txt requirements.txt\n#6 CACHED\n\n#7 [3/7] WORKDIR /app\n#7 CACHED\n\n#8 [6/7] RUN pip install --no-cache-dir prometheus_client\n#8 CACHED\n\n#9 [2/7] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg pkg-config libmariadb-dev gcc &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*\n#9 CACHED\n\n#10 [5/7] RUN pip install --no-cache-dir -r requirements.txt\n#10 CACHED\n\n#11 [7/7] COPY . .\n#11 CACHED\n\n#12 exporting to image\n#12 exporting layers done\n#12 writing image sha256:542dd62c6c6f422adaf056977842a41abbc150a2886086ffe3e62f5bbb4313ca done\n#12 naming to docker.io/library/ansible_project_app done\n#12 DONE 0.0s\nBuilding webserver\n#0 building with \"default\" instance using docker driver\n\n#1 [internal] load build definition from Dockerfile\n#1 transferring dockerfile: 205B done\n#1 DONE 0.0s\n\n#2 [internal] load metadata for docker.io/library/nginx:latest\n#2 DONE 1.7s\n\n#3 [internal] load .dockerignore\n#3 transferring context: 2B done\n#3 DONE 0.0s\n\n#4 [1/4] FROM docker.io/library/nginx:latest@sha256:447a8665cc1dab95b1ca778e162215839ccbb9189104c79d7ec3a81e14577add\n#4 DONE 0.0s\n\n#5 [internal] load build context\n#5 transferring context: 91B done\n#5 DONE 0.0s\n\n#6 [2/4] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg\n#6 CACHED\n\n#7 [3/4] COPY nginx.conf /etc/nginx/nginx.conf\n#7 CACHED\n\n#8 [4/4] COPY html /usr/share/nginx/html\n#8 CACHED\n\n#9 exporting to image\n#9 exporting layers done\n#9 writing image sha256:69b1305a98d98d24d9dfaa133af68b27e5fb71157ed3e78c6afb5916b9317f19 done\n#9 naming to docker.io/library/ansible_project_webserver done\n#9 DONE 0.0s\nBuilding proxyserver\n#0 building with \"default\" instance using docker driver\n\n#1 [internal] load build definition from Dockerfile\n#1 transferring dockerfile: 173B done\n#1 DONE 0.0s\n\n#2 [internal] load metadata for docker.io/library/nginx:latest\n#2 DONE 0.5s\n\n#3 [internal] load .dockerignore\n#3 transferring context: 2B done\n#3 DONE 0.0s\n\n#4 [1/3] FROM docker.io/library/nginx:latest@sha256:447a8665cc1dab95b1ca778e162215839ccbb9189104c79d7ec3a81e14577add\n#4 DONE 0.0s\n\n#5 [internal] load build context\n#5 transferring context: 32B done\n#5 DONE 0.0s\n\n#6 [2/3] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg\n#6 CACHED\n\n#7 [3/3] COPY nginx.conf /etc/nginx/nginx.conf\n#7 CACHED\n\n#8 exporting to image\n#8 exporting layers done\n#8 writing image sha256:8d623ca940de3104155202c143872fb567978fe37a01964c1f85b77795a4da6d done\n#8 naming to docker.io/library/ansible_project_proxyserver done\n#8 DONE 0.0s\nCreating node_exporter ... \r\nCreating grafana       ... \r\nCreating nginx_prometheus_exporter ... \r\nCreating prometheus                ... \r\nCreating db                        ... \r\nHost is already in use by another container\nCreating db                        ... error\r\n\nERROR: for db  Cannot start service db: driver failed programming external connectivity on endpoint db (bef75c586e1aebd597c3082b4cc5ede2ab1bd6d9c3334834c191631a268cfdd3): failed to bind port 0.0.0.0:3306/tcp: Error starting userland proxy: listen tcp4 0.0.0.0:3306: bind: address already in use\nCreating prometheus                ... done\r\nCreating grafana                   ... done\r\nCreating nginx_prometheus_exporter ... done\r\nCreating node_exporter             ... done\r\n\nERROR: for db  Cannot start service db: driver failed programming external connectivity on endpoint db (bef75c586e1aebd597c3082b4cc5ede2ab1bd6d9c3334834c191631a268cfdd3): failed to bind port 0.0.0.0:3306/tcp: Error starting userland proxy: listen tcp4 0.0.0.0:3306: bind: address already in use\nEncountered errors while bringing up the project.", "stderr_lines": ["Some networks were defined but are not used by any service: elk-network", "Creating network \"ansible_project_app-network\" with driver \"bridge\"", "Building app", "#0 building with \"default\" instance using docker driver", "", "#1 [internal] load build definition from Dockerfile", "#1 transferring dockerfile: 633B done", "#1 DONE 0.0s", "", "#2 [internal] load metadata for docker.io/library/python:3.9-slim", "#2 DONE 1.9s", "", "#3 [internal] load .dockerignore", "#3 transferring context: 2B done", "#3 DONE 0.0s", "", "#4 [1/7] FROM docker.io/library/python:3.9-slim@sha256:1e3437daae1d9cebce372794eacfac254dd108200e47c8b7f56a633ebd3e2a0a", "#4 DONE 0.0s", "", "#5 [internal] load build context", "#5 transferring context: 654B done", "#5 DONE 0.0s", "", "#6 [4/7] COPY requirements.txt requirements.txt", "#6 CACHED", "", "#7 [3/7] WORKDIR /app", "#7 CACHED", "", "#8 [6/7] RUN pip install --no-cache-dir prometheus_client", "#8 CACHED", "", "#9 [2/7] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg pkg-config libmariadb-dev gcc &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "#9 CACHED", "", "#10 [5/7] RUN pip install --no-cache-dir -r requirements.txt", "#10 CACHED", "", "#11 [7/7] COPY . .", "#11 CACHED", "", "#12 exporting to image", "#12 exporting layers done", "#12 writing image sha256:542dd62c6c6f422adaf056977842a41abbc150a2886086ffe3e62f5bbb4313ca done", "#12 naming to docker.io/library/ansible_project_app done", "#12 DONE 0.0s", "Building webserver", "#0 building with \"default\" instance using docker driver", "", "#1 [internal] load build definition from Dockerfile", "#1 transferring dockerfile: 205B done", "#1 DONE 0.0s", "", "#2 [internal] load metadata for docker.io/library/nginx:latest", "#2 DONE 1.7s", "", "#3 [internal] load .dockerignore", "#3 transferring context: 2B done", "#3 DONE 0.0s", "", "#4 [1/4] FROM docker.io/library/nginx:latest@sha256:447a8665cc1dab95b1ca778e162215839ccbb9189104c79d7ec3a81e14577add", "#4 DONE 0.0s", "", "#5 [internal] load build context", "#5 transferring context: 91B done", "#5 DONE 0.0s", "", "#6 [2/4] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg", "#6 CACHED", "", "#7 [3/4] COPY nginx.conf /etc/nginx/nginx.conf", "#7 CACHED", "", "#8 [4/4] COPY html /usr/share/nginx/html", "#8 CACHED", "", "#9 exporting to image", "#9 exporting layers done", "#9 writing image sha256:69b1305a98d98d24d9dfaa133af68b27e5fb71157ed3e78c6afb5916b9317f19 done", "#9 naming to docker.io/library/ansible_project_webserver done", "#9 DONE 0.0s", "Building proxyserver", "#0 building with \"default\" instance using docker driver", "", "#1 [internal] load build definition from Dockerfile", "#1 transferring dockerfile: 173B done", "#1 DONE 0.0s", "", "#2 [internal] load metadata for docker.io/library/nginx:latest", "#2 DONE 0.5s", "", "#3 [internal] load .dockerignore", "#3 transferring context: 2B done", "#3 DONE 0.0s", "", "#4 [1/3] FROM docker.io/library/nginx:latest@sha256:447a8665cc1dab95b1ca778e162215839ccbb9189104c79d7ec3a81e14577add", "#4 DONE 0.0s", "", "#5 [internal] load build context", "#5 transferring context: 32B done", "#5 DONE 0.0s", "", "#6 [2/3] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg", "#6 CACHED", "", "#7 [3/3] COPY nginx.conf /etc/nginx/nginx.conf", "#7 CACHED", "", "#8 exporting to image", "#8 exporting layers done", "#8 writing image sha256:8d623ca940de3104155202c143872fb567978fe37a01964c1f85b77795a4da6d done", "#8 naming to docker.io/library/ansible_project_proxyserver done", "#8 DONE 0.0s", "Creating node_exporter ... ", "Creating grafana       ... ", "Creating nginx_prometheus_exporter ... ", "Creating prometheus                ... ", "Creating db                        ... ", "Host is already in use by another container", "Creating db                        ... error", "", "ERROR: for db  Cannot start service db: driver failed programming external connectivity on endpoint db (bef75c586e1aebd597c3082b4cc5ede2ab1bd6d9c3334834c191631a268cfdd3): failed to bind port 0.0.0.0:3306/tcp: Error starting userland proxy: listen tcp4 0.0.0.0:3306: bind: address already in use", "Creating prometheus                ... done", "Creating grafana                   ... done", "Creating nginx_prometheus_exporter ... done", "Creating node_exporter             ... done", "", "ERROR: for db  Cannot start service db: driver failed programming external connectivity on endpoint db (bef75c586e1aebd597c3082b4cc5ede2ab1bd6d9c3334834c191631a268cfdd3): failed to bind port 0.0.0.0:3306/tcp: Error starting userland proxy: listen tcp4 0.0.0.0:3306: bind: address already in use", "Encountered errors while bringing up the project."], "stdout": "", "stdout_lines": []}
fatal: [Docker-WEB-WAS-DB-ExMid-2]: FAILED! => {"changed": true, "cmd": "docker-compose -f /opt/MOKONIX/ansible_project/docker-compose.yml up -d --build", "delta": "0:00:06.618397", "end": "2024-08-29 10:26:18.353637", "msg": "non-zero return code", "rc": 1, "start": "2024-08-29 10:26:11.735240", "stderr": "Some networks were defined but are not used by any service: elk-network\nCreating network \"ansible_project_app-network\" with driver \"bridge\"\nBuilding app\n#0 building with \"default\" instance using docker driver\n\n#1 [internal] load build definition from Dockerfile\n#1 transferring dockerfile: 633B done\n#1 DONE 0.0s\n\n#2 [internal] load metadata for docker.io/library/python:3.9-slim\n#2 DONE 1.9s\n\n#3 [internal] load .dockerignore\n#3 transferring context: 2B done\n#3 DONE 0.0s\n\n#4 [1/7] FROM docker.io/library/python:3.9-slim@sha256:1e3437daae1d9cebce372794eacfac254dd108200e47c8b7f56a633ebd3e2a0a\n#4 DONE 0.0s\n\n#5 [internal] load build context\n#5 transferring context: 654B done\n#5 DONE 0.0s\n\n#6 [3/7] WORKDIR /app\n#6 CACHED\n\n#7 [4/7] COPY requirements.txt requirements.txt\n#7 CACHED\n\n#8 [5/7] RUN pip install --no-cache-dir -r requirements.txt\n#8 CACHED\n\n#9 [2/7] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg pkg-config libmariadb-dev gcc &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*\n#9 CACHED\n\n#10 [6/7] RUN pip install --no-cache-dir prometheus_client\n#10 CACHED\n\n#11 [7/7] COPY . .\n#11 CACHED\n\n#12 exporting to image\n#12 exporting layers done\n#12 writing image sha256:c27cf603e36a41d62aa2769a8a9b226047332897f490924ff3eb5acd7b97aa15 done\n#12 naming to docker.io/library/ansible_project_app done\n#12 DONE 0.0s\nBuilding webserver\n#0 building with \"default\" instance using docker driver\n\n#1 [internal] load build definition from Dockerfile\n#1 transferring dockerfile: 205B done\n#1 DONE 0.0s\n\n#2 [internal] load metadata for docker.io/library/nginx:latest\n#2 DONE 1.7s\n\n#3 [internal] load .dockerignore\n#3 transferring context: 2B done\n#3 DONE 0.0s\n\n#4 [1/4] FROM docker.io/library/nginx:latest@sha256:447a8665cc1dab95b1ca778e162215839ccbb9189104c79d7ec3a81e14577add\n#4 DONE 0.0s\n\n#5 [internal] load build context\n#5 transferring context: 91B done\n#5 DONE 0.0s\n\n#6 [2/4] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg\n#6 CACHED\n\n#7 [3/4] COPY nginx.conf /etc/nginx/nginx.conf\n#7 CACHED\n\n#8 [4/4] COPY html /usr/share/nginx/html\n#8 CACHED\n\n#9 exporting to image\n#9 exporting layers done\n#9 writing image sha256:c8d3b9a99b57ffa130ec9eea31e2dc78038655979edea52a01e1303a7f5f3c3e done\n#9 naming to docker.io/library/ansible_project_webserver done\n#9 DONE 0.0s\nBuilding proxyserver\n#0 building with \"default\" instance using docker driver\n\n#1 [internal] load build definition from Dockerfile\n#1 transferring dockerfile: 173B done\n#1 DONE 0.0s\n\n#2 [internal] load metadata for docker.io/library/nginx:latest\n#2 DONE 0.5s\n\n#3 [internal] load .dockerignore\n#3 transferring context: 2B done\n#3 DONE 0.0s\n\n#4 [1/3] FROM docker.io/library/nginx:latest@sha256:447a8665cc1dab95b1ca778e162215839ccbb9189104c79d7ec3a81e14577add\n#4 DONE 0.0s\n\n#5 [internal] load build context\n#5 transferring context: 32B done\n#5 DONE 0.0s\n\n#6 [2/3] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg\n#6 CACHED\n\n#7 [3/3] COPY nginx.conf /etc/nginx/nginx.conf\n#7 CACHED\n\n#8 exporting to image\n#8 exporting layers done\n#8 writing image sha256:37ac2c13c0ec9d2be13830712f01493f35b289302f722fb534b1c6c621888506 done\n#8 naming to docker.io/library/ansible_project_proxyserver done\n#8 DONE 0.0s\nCreating node_exporter ... \r\nCreating prometheus    ... \r\nCreating db            ... \r\nCreating grafana       ... \r\nCreating nginx_prometheus_exporter ... \r\nHost is already in use by another container\nCreating db                        ... error\r\n\nERROR: for db  Cannot start service db: driver failed programming external connectivity on endpoint db (3890509af1c308b634b0e954ec7478a050aea4c7531099320595693e93db6920): failed to bind port 0.0.0.0:3306/tcp: Error starting userland proxy: listen tcp4 0.0.0.0:3306: bind: address already in use\nCreating node_exporter             ... done\r\nCreating nginx_prometheus_exporter ... done\r\nCreating grafana                   ... done\r\nCreating prometheus                ... done\r\n\nERROR: for db  Cannot start service db: driver failed programming external connectivity on endpoint db (3890509af1c308b634b0e954ec7478a050aea4c7531099320595693e93db6920): failed to bind port 0.0.0.0:3306/tcp: Error starting userland proxy: listen tcp4 0.0.0.0:3306: bind: address already in use\nEncountered errors while bringing up the project.", "stderr_lines": ["Some networks were defined but are not used by any service: elk-network", "Creating network \"ansible_project_app-network\" with driver \"bridge\"", "Building app", "#0 building with \"default\" instance using docker driver", "", "#1 [internal] load build definition from Dockerfile", "#1 transferring dockerfile: 633B done", "#1 DONE 0.0s", "", "#2 [internal] load metadata for docker.io/library/python:3.9-slim", "#2 DONE 1.9s", "", "#3 [internal] load .dockerignore", "#3 transferring context: 2B done", "#3 DONE 0.0s", "", "#4 [1/7] FROM docker.io/library/python:3.9-slim@sha256:1e3437daae1d9cebce372794eacfac254dd108200e47c8b7f56a633ebd3e2a0a", "#4 DONE 0.0s", "", "#5 [internal] load build context", "#5 transferring context: 654B done", "#5 DONE 0.0s", "", "#6 [3/7] WORKDIR /app", "#6 CACHED", "", "#7 [4/7] COPY requirements.txt requirements.txt", "#7 CACHED", "", "#8 [5/7] RUN pip install --no-cache-dir -r requirements.txt", "#8 CACHED", "", "#9 [2/7] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg pkg-config libmariadb-dev gcc &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "#9 CACHED", "", "#10 [6/7] RUN pip install --no-cache-dir prometheus_client", "#10 CACHED", "", "#11 [7/7] COPY . .", "#11 CACHED", "", "#12 exporting to image", "#12 exporting layers done", "#12 writing image sha256:c27cf603e36a41d62aa2769a8a9b226047332897f490924ff3eb5acd7b97aa15 done", "#12 naming to docker.io/library/ansible_project_app done", "#12 DONE 0.0s", "Building webserver", "#0 building with \"default\" instance using docker driver", "", "#1 [internal] load build definition from Dockerfile", "#1 transferring dockerfile: 205B done", "#1 DONE 0.0s", "", "#2 [internal] load metadata for docker.io/library/nginx:latest", "#2 DONE 1.7s", "", "#3 [internal] load .dockerignore", "#3 transferring context: 2B done", "#3 DONE 0.0s", "", "#4 [1/4] FROM docker.io/library/nginx:latest@sha256:447a8665cc1dab95b1ca778e162215839ccbb9189104c79d7ec3a81e14577add", "#4 DONE 0.0s", "", "#5 [internal] load build context", "#5 transferring context: 91B done", "#5 DONE 0.0s", "", "#6 [2/4] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg", "#6 CACHED", "", "#7 [3/4] COPY nginx.conf /etc/nginx/nginx.conf", "#7 CACHED", "", "#8 [4/4] COPY html /usr/share/nginx/html", "#8 CACHED", "", "#9 exporting to image", "#9 exporting layers done", "#9 writing image sha256:c8d3b9a99b57ffa130ec9eea31e2dc78038655979edea52a01e1303a7f5f3c3e done", "#9 naming to docker.io/library/ansible_project_webserver done", "#9 DONE 0.0s", "Building proxyserver", "#0 building with \"default\" instance using docker driver", "", "#1 [internal] load build definition from Dockerfile", "#1 transferring dockerfile: 173B done", "#1 DONE 0.0s", "", "#2 [internal] load metadata for docker.io/library/nginx:latest", "#2 DONE 0.5s", "", "#3 [internal] load .dockerignore", "#3 transferring context: 2B done", "#3 DONE 0.0s", "", "#4 [1/3] FROM docker.io/library/nginx:latest@sha256:447a8665cc1dab95b1ca778e162215839ccbb9189104c79d7ec3a81e14577add", "#4 DONE 0.0s", "", "#5 [internal] load build context", "#5 transferring context: 32B done", "#5 DONE 0.0s", "", "#6 [2/3] RUN apt-get update &&     apt-get install -y sudo python3 vim wget gnupg", "#6 CACHED", "", "#7 [3/3] COPY nginx.conf /etc/nginx/nginx.conf", "#7 CACHED", "", "#8 exporting to image", "#8 exporting layers done", "#8 writing image sha256:37ac2c13c0ec9d2be13830712f01493f35b289302f722fb534b1c6c621888506 done", "#8 naming to docker.io/library/ansible_project_proxyserver done", "#8 DONE 0.0s", "Creating node_exporter ... ", "Creating prometheus    ... ", "Creating db            ... ", "Creating grafana       ... ", "Creating nginx_prometheus_exporter ... ", "Host is already in use by another container", "Creating db                        ... error", "", "ERROR: for db  Cannot start service db: driver failed programming external connectivity on endpoint db (3890509af1c308b634b0e954ec7478a050aea4c7531099320595693e93db6920): failed to bind port 0.0.0.0:3306/tcp: Error starting userland proxy: listen tcp4 0.0.0.0:3306: bind: address already in use", "Creating node_exporter             ... done", "Creating nginx_prometheus_exporter ... done", "Creating grafana                   ... done", "Creating prometheus                ... done", "", "ERROR: for db  Cannot start service db: driver failed programming external connectivity on endpoint db (3890509af1c308b634b0e954ec7478a050aea4c7531099320595693e93db6920): failed to bind port 0.0.0.0:3306/tcp: Error starting userland proxy: listen tcp4 0.0.0.0:3306: bind: address already in use", "Encountered errors while bringing up the project."], "stdout": "", "stdout_lines": []}

PLAY RECAP *********************************************************************
Docker-WEB-WAS-DB-ExMid-1  : ok=16   changed=9    unreachable=0    failed=1    skipped=2    rescued=0    ignored=1   
Docker-WEB-WAS-DB-ExMid-2  : ok=16   changed=9    unreachable=0    failed=1    skipped=2    rescued=0    ignored=1   
